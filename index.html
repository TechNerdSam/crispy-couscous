<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portefeuille Java - @TechNerdSam</title>
    
    <!-- Importation de Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuration de Tailwind (optionnel, mais assure la police) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'brand-primary': '#6366F1', // Indigo-500
                        'brand-secondary': '#D946EF', // Fuchsia-500 (Nouveau)
                        'base-900': '#0B1120', // Plus sombre
                        'base-800': '#1A2233', // Plus sombre
                        'base-700': '#2A354A', // Plus sombre
                        'base-text': '#E2E8F0', // Slate-200
                        'base-subtext': '#94A3B8', // Slate-400
                    }
                }
            }
        }
    </script>
    
    <!-- Styles CSS personnalisés -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0B1120; /* base-900 (Nouveau) */
            color: #E2E8F0; /* base-text */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Effet de dégradé subtil sur l'arrière-plan (Nouveau) */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 5% 15%, rgba(99, 102, 241, 0.15), transparent 40%),
                        radial-gradient(circle at 95% 85%, rgba(217, 70, 239, 0.15), transparent 40%);
            opacity: 0.8;
            pointer-events: none; /* Assure que le pseudo-élément n'interfère pas */
        }

        /* Style de la barre de défilement (Nouveau) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1A2233; /* base-800 (Nouveau) */
        }
        ::-webkit-scrollbar-thumb {
            background-color: #2A354A; /* base-700 (Nouveau) */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #3E4C6E; /* Slate-600 ajusté */
        }
        
        /* Classe pour l'animation d'apparition */
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="min-h-screen">

    <!-- Conteneur principal -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">

        <!-- En-tête -->
        <header class="text-center mb-16 fade-in" style="animation-delay: 100ms;">
            <!-- Conteneur de l'image avec bordure en dégradé (Nouveau) -->
            <div class="inline-block p-1 bg-gradient-to-br from-brand-primary to-brand-secondary rounded-full shadow-lg mb-4">
                <!-- Placeholder pour une image de profil -->
                <img class="h-32 w-32 rounded-full border-4 border-base-900" 
                     src="https://github.com/TechNerdSam.png" 
                     alt="Profil de TechNerdSam"
                     onerror="this.onerror=null; this.src='https://placehold.co/128x128/0B1120/E2E8F0?text=TS';">
            </div>
            <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-brand-primary to-brand-secondary">
                Portefeuille Java
            </h1>
            <p class="mt-4 text-xl text-base-subtext">
                Une collection de projets Java par @TechNerdSam
            </p>
        </header>

        <!-- Section des projets -->
        <main>
            <!-- Message de statut (chargement, erreur, etc.) -->
            <div id="status-message" class="text-center text-base-subtext text-lg my-12">
                <!-- Le JavaScript remplira ce message -->
            </div>

            <!-- Grille des projets -->
            <div id="project-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Les cartes de projet seront injectées ici par JavaScript -->
            </div>
        </main>

        <!-- Pied de page -->
        <footer class="text-center text-base-subtext mt-20 border-t border-base-700/50 pt-8"> <!-- Opacité bordure (Nouveau) -->
            <p>&copy; <span id="current-year"></span>. Propulsé par l'API GitHub et Tailwind CSS.</p>
        </footer>
    </div>

    <!-- Script JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const USERNAME = 'TechNerdSam';

            // --- FIX POUR LA LIMITE API ---
            // Collez votre jeton d'accès personnel (Personal Access Token) GitHub ici.
            // Cela permet d'augmenter la limite de requêtes API de 60 à 5000/heure.
            // 1. Allez sur https://github.com/settings/tokens
            // 2. Cliquez sur "Generate new token" (ou "classic").
            // 3. Donnez-lui un nom (ex: "PortfolioSite") et cochez la case "public_repo".
            // 4. Copiez le jeton et collez-le entre les guillemets ci-dessous.
            const GITHUB_TOKEN = ''; // <--- METTEZ VOTRE JETON (PAT) ICI
            // -----------------------------

            const API_URL = `https://api.github.com/users/${USERNAME}/repos?sort=updated&per_page=100`;

            const projectGrid = document.getElementById('project-grid');
            const statusMessage = document.getElementById('status-message');
            document.getElementById('current-year').textContent = new Date().getFullYear();

            // Icônes SVG pour les cartes
            const starIcon = `
                <svg class="w-4 h-4 mr-1 inline-block" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
            `;
            const forkIcon = `
                <svg class="w-4 h-4 mr-1 inline-block" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path></svg>
                <!-- Utilisation d'une icône "éclair" pour "fork", pour un look plus futuriste. On peut remplacer par une icône de fork classique si besoin. -->
            `;
            
            const downloadIcon = `
                <svg class="w-4 h-4 mr-2 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
            `;
            
            const linkIcon = `
                <svg class="w-4 h-4 mr-2 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
            `;

            /**
              * Crée une carte de projet et l'ajoute à la grille.
              * @param {object} repo - L'objet dépôt de l'API GitHub
              * @param {number} delay - Le délai d'animation
              * @param {string} repoUrl - L'URL du dépôt GitHub
              * @param {string | null} downloadUrl - L'URL de téléchargement de la release (ou null)
              */
            function createProjectCard(repo, delay, repoUrl, downloadUrl) {
                const card = document.createElement('div');
                // Style de carte mis à jour (Nouveau)
                card.className = 'fade-in flex flex-col bg-base-800/60 backdrop-blur-md border border-base-700/70 rounded-xl shadow-2xl shadow-black/30 transition-all duration-300 hover:scale-[1.03] hover:border-transparent hover:shadow-[0_0_25px_rgba(99,102,241,0.5)] overflow-hidden';
                card.style.animationDelay = `${delay}ms`;

                // Corps de la carte
                const cardBody = document.createElement('div');
                cardBody.className = 'p-6 flex-grow flex flex-col';
                
                // Nom du projet
                const repoName = document.createElement('h3');
                repoName.className = 'text-xl font-bold text-base-text mb-2 truncate';
                repoName.textContent = repo.name;

                // Description
                const repoDescription = document.createElement('p');
                repoDescription.className = 'text-sm text-base-subtext mb-4 flex-grow';
                repoDescription.textContent = repo.description || 'Aucune description fournie.';
                
                // Statistiques
                const stats = document.createElement('div');
                stats.className = 'flex items-center text-sm text-base-subtext space-x-4 mb-5';
                stats.innerHTML = `
                    <span class="flex items-center" title="${repo.stargazers_count} étoiles">
                        ${starIcon}
                        ${repo.stargazers_count}
                    </span>
                    <span class="flex items-center" title="${repo.forks_count} forks">
                        ${forkIcon}
                        ${repo.forks_count}
                    </span>
                    <span class="font-medium text-brand-secondary">${repo.language}</span> <!-- Couleur secondaire (Nouveau) -->
                `;

                // Conteneur pour les boutons (Nouveau)
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'mt-auto grid grid-cols-1 gap-3'; // Sera 1 colonne par défaut
                
                // S'il y a un lien de téléchargement, on passe en 2 colonnes sur écrans moyens
                if (downloadUrl) {
                    buttonContainer.classList.remove('grid-cols-1');
                    buttonContainer.classList.add('sm:grid-cols-2'); // 2 colonnes sur sm et plus
                }

                // 1. Bouton "Télécharger" (si disponible)
                if (downloadUrl) {
                    const downloadLink = document.createElement('a');
                    downloadLink.href = downloadUrl;
                    downloadLink.target = '_blank'; // Ouvre dans un nouvel onglet
                    downloadLink.rel = 'noopener noreferrer';
                    downloadLink.className = 'text-center w-full inline-flex items-center justify-center px-5 py-2.5 bg-gradient-to-r from-brand-primary to-brand-secondary text-white text-sm font-semibold rounded-lg shadow-lg shadow-brand-primary/30 hover:shadow-xl hover:shadow-brand-primary/40 hover:scale-105 transition-all duration-300 transform';
                    downloadLink.innerHTML = `${downloadIcon} Télécharger`;
                    buttonContainer.appendChild(downloadLink);
                }

                // 2. Bouton "Voir sur GitHub" (toujours présent)
                const repoLink = document.createElement('a');
                repoLink.href = repoUrl;
                repoLink.target = '_blank';
                repoLink.rel = 'noopener noreferrer';
                
                // Style différent si le bouton "Télécharger" existe
                if (downloadUrl) {
                    // Style secondaire (bordure)
                    repoLink.className = 'text-center w-full inline-flex items-center justify-center px-5 py-2.5 bg-transparent border border-base-700 text-base-subtext text-sm font-medium rounded-lg hover:text-base-text hover:border-brand-primary transition-all duration-300';
                } else {
                    // Style principal (dégradé) car c'est le seul bouton
                    repoLink.className = 'text-center w-full inline-flex items-center justify-center px-5 py-2.5 bg-gradient-to-r from-brand-primary to-brand-secondary text-white text-sm font-semibold rounded-lg shadow-lg shadow-brand-primary/30 hover:shadow-xl hover:shadow-brand-primary/40 hover:scale-105 transition-all duration-300 transform';
                }
                
                repoLink.innerHTML = `${linkIcon} Voir sur GitHub`;
                buttonContainer.appendChild(repoLink);


                // Assemblage de la carte
                cardBody.appendChild(repoName);
                cardBody.appendChild(repoDescription);
                cardBody.appendChild(stats);
                cardBody.appendChild(buttonContainer); // Ajout du conteneur de boutons
                card.appendChild(cardBody);

                projectGrid.appendChild(card);
            }

            /**
             * Tente de trouver la dernière release pour un dépôt.
             * Retourne un objet avec l'URL du repo et l'URL de téléchargement (si elle existe).
             */
            async function fetchLatestRelease(repo, headers) {
                const releaseUrl = `https://api.github.com/repos/${USERNAME}/${repo.name}/releases/latest`;
                let assetDownloadUrl = null; // Initialiser à null

                try {
                    const response = await fetch(releaseUrl, { headers });
                    if (response.ok) { // Une release existe
                        const release = await response.json();
                        // Chercher un asset .jar ou .zip
                        const asset = release.assets?.find(a => 
                            a.name.endsWith('.jar') || a.name.endsWith('.zip')
                        );
                        
                        if (asset) {
                            assetDownloadUrl = asset.browser_download_url; // On a trouvé un asset
                        }
                    }
                    // Si !response.ok (pas de release), assetDownloadUrl reste null, ce qui est correct.
                } catch (error) {
                    console.warn(`Impossible de vérifier les releases pour ${repo.name}:`, error);
                }
                
                // Toujours retourner l'URL du repo et l'URL de téléchargement (si trouvée)
                return { 
                    repoUrl: repo.html_url, 
                    downloadUrl: assetDownloadUrl 
                };
            }

            /**
             * Fonction principale pour récupérer les dépôts.
             */
            async function fetchRepos() {
                statusMessage.textContent = 'Chargement des projets Java...';
                let animationDelay = 0;

                // Ajout d'un avertissement si le jeton est manquant
                if (!GITHUB_TOKEN) {
                    console.warn('GITHUB_TOKEN est vide. Vous risquez de rencontrer des limites de taux API de GitHub.');
                    statusMessage.innerHTML = 'Chargement... <br><span class="text-sm text-yellow-400 mt-2 block">Note : Ajoutez un GITHUB_TOKEN dans le script pour éviter les erreurs de limite API.</span>';
                }

                const headers = {};
                if (GITHUB_TOKEN) {
                    headers['Authorization'] = `Bearer ${GITHUB_TOKEN}`;
                }

                try {
                    // Ajout des 'headers' à l'appel fetch
                    const response = await fetch(API_URL, { headers: headers });
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            throw new Error('Profil GitHub non trouvé.');
                        } else if (response.status === 403) {
                            const resetTime = new Date(response.headers.get('X-RateLimit-Reset') * 1000);
                            throw new Error(`Limite d'appels à l'API GitHub atteinte. Réessayez après ${resetTime.toLocaleTimeString()}.`);
                        }
                        throw new Error(`Erreur réseau: ${response.statusText}`);
                    }

                    const repos = await response.json();
                    
                    // Filtrer pour ne garder que les projets Java
                    const javaRepos = repos.filter(repo => repo.language === 'Java' && !repo.archived);

                    if (javaRepos.length === 0) {
                        statusMessage.textContent = 'Aucun projet Java public trouvé pour ce profil.';
                    } else {
                        statusMessage.style.display = 'none'; // Cacher le message de statut
                        
                        // Créer un tableau de promesses pour fetch les releases
                        const releasePromises = javaRepos.map(repo => fetchLatestRelease(repo, headers));
                        
                        // Attendre que toutes les vérifications de release soient terminées
                        const results = await Promise.all(releasePromises);

                        // Maintenant, créer les cartes avec les bonnes infos
                        results.forEach((result, index) => {
                            const repo = javaRepos[index]; // L'ordre est conservé
                            createProjectCard(
                                repo, 
                                animationDelay, 
                                result.repoUrl,     // URL du repo
                                result.downloadUrl   // URL de la release (ou null)
                            );
                            animationDelay += 100; // Décalage pour l'animation
                        });
                    }

                } catch (error) {
                    console.error('Erreur lors de la récupération des dépôts:', error);
                    statusMessage.textContent = `Erreur : ${error.message}`;
                    statusMessage.className = 'text-center text-red-400 text-lg my-12';
                }
            }

            // Démarrer la récupération
            fetchRepos();
        });
    </script>

</body>
</html>


